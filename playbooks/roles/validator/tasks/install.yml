---
- name: clone wasmd repo
  git:
    repo: 'https://github.com/oraichain/wasmd'
    dest: /tmp/wasmd
    version: "{{ orai_version }}"

- name: Run 'install' target to compile
  community.general.make:
    chdir: "/tmp/wasmd"
    target: install
  become: true
  tags: fetch_build

#- name: move oraid binary to go/bin
#  ansible.builtin.command:
#    cmd: mv /home/orai/wasmd/build/oraid /home/orai/go/bin/oraid

- name: Install cosmovissor
  command: /usr/local/go/bin/go install github.com/cosmos/cosmos-sdk/cosmovisor/cmd/cosmovisor@latest
  args:
    chdir: "{{ orai_HOME }}/go/bin"
    creates: $HOME/go/bin/cosmovisor"
  tags: install_cosmovisor
